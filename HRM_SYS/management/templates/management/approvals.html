{% extends 'management/base.html' %}
{% load crispy_forms_tags %}
{% block content %}
     <!-- create camera modal here-->

     






      <!-- partial -->
      <div class="main-panel">        
        <div class="content-wrapper">
          <div class="row">
           
          
              
            <div class="col-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Initiate approvals</h4>
                  <p class="card-description">
                    <div id="loaders5" style="display: none;">
                      <div class="spinner-grow text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                      <div class="spinner-grow text-secondary" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                      <div class="spinner-grow text-success" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                      </div>
                    
                  </p>
                  <form class="forms-sample" ectype="multipart/form-data" method="POST" id="ApprovalForm">
                    {% csrf_token %}
                    
                 
                    <div class="form-group">
                       {{appForm.approvals | as_crispy_field}}
                    </div>
                    <div class="form-group">
                      {{appForm.media}}
                      {{appForm.details}}
                   </div>
                   <div class="form-group">
                    
                    {{appForm.attachments}}
                 </div>
        
                   
             
                   
                    <button type="submit" class="btn btn-primary mr-2" onclick="loadApproval()">Submit</button>
                    <button class="btn btn-light">Cancel</button>
                  </form>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <!-- content-wrapper ends -->
        <!-- partial:../../partials/_footer.html -->
        <footer class="footer">
          
        </footer>
        <!-- partial -->
      </div>

    <script>

function loadApproval(){
  
  $("#ApprovalForm").submit(function(e){
   e.preventDefault()

   $form = $(this)
   var formData = new FormData(this);
 
   $.ajax({
     method:"post",
     url:"{% url 'management_upload_process' %}",
     data:formData,
     processData: false,
contentType: false,
beforeSend:function(){
                $("#loaders5").show()
             },
     success:function(data,status){
       alert(data)
     },
     complete:function(){
                
                $("#loaders5").hide()
                location.reload()
  
               }
   })
  })

}
    
    </script>
  {% endblock content %}

  