{% extends 'management/base.html' %}
{% block content %}

<style>
 
  .tree {
    min-height:20px;
    padding:19px;
    margin-bottom:20px;
    background-color:#fbfbfb;
    border:1px solid #999;
    -webkit-border-radius:4px;
    -moz-border-radius:4px;
    border-radius:4px;
    -webkit-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
    -moz-box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05);
    box-shadow:inset 0 1px 1px rgba(0, 0, 0, 0.05)
}
.tree li {
    list-style-type:none;
    margin:0;
    padding:10px 5px 0 5px;
    position:relative
}
.tree li::before, .tree li::after {
    content:'';
    left:-20px;
    position:absolute;
    right:auto
}
.tree li::before {
    border-left:1px solid #999;
    bottom:50px;
    height:100%;
    top:0;
    width:1px
}
.tree li::after {
    border-top:1px solid #999;
    height:20px;
    top:25px;
    width:25px
}
.tree li span {
    -moz-border-radius:5px;
    -webkit-border-radius:5px;
    border:1px solid #999;
    border-radius:5px;
    display:inline-block;
    padding:3px 8px;
    text-decoration:none
}
.tree li.parent_li>span {
    cursor:pointer
}
.tree>ul>li::before, .tree>ul>li::after {
    border:0
}
.tree li:last-child::before {management_create_approval
    height:30px
}
.tree li.parent_li>span:hover, .tree li.parent_li>span:hover+ul li span {
    background:#eee;
    border:1px solid #94a0b4;
    color:#000
}
  .parent {
    overflow-y: scroll;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none;  /* Internet Explorer 10+ */
}
.parent::-webkit-scrollbar { /* WebKit */
    width: 0;
    height: 0;
}
</style>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-md-12 grid-margin">
              <div class="row">
                <div class="col-12 col-xl-8 mb-4 mb-xl-0">
                  <h3 class="font-weight-bold">Welcome</h3>
                  <h4 class="font-weight-normal mb-0" style="color:yellowgreen"> {{user.username}}@{{user.profile.first}} </h4>
                  <div id="loaders5" style="display: none;">
                    <div class="spinner-grow text-primary" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-secondary" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-success" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    </div>
                 
                                        </div>
                <div class="col-12 col-xl-4">
            
                  {% if nots > 0 %}
                    <a href="{% url 'management_notifications' %}"><i class="fa fa-bell"></i>you have {{nots}} unread approval notifications</a>
                  {% endif %}
                  
                  
                 <div class="justify-content-end d-flex">
                  <div class="dropdown flex-md-grow-1 flex-xl-grow-0">
                    
                      <span id="statusText" style="color:orange"></span>
                  
                    
                  </div>
                 </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            
            <div class="col-md-6 grid-margin stretch-card">
              <div class="card tale-bg">
                <div class="card-people mt-auto">
                  <img src="https://images.unsplash.com/photo-1549002942-c6af9c116f79?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OXx8c3VubGlnaHR8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60" height="300px;" alt="people" id="statusPic">
                  <div class="weather-info">
                    <div class="d-flex">
                      <div>
                        <h2 class="mb-0 font-weight-normal"><strong id="temps"></strong><sup>C</sup></h2>
                      </div>
                      <div class="ml-2">
                        <h4 class="location font-weight-normal">Nairobi</h4>
                        <h6 class="font-weight-normal">Kenya</h6>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 grid-margin transparent">
              
              <div class="row">
                <div class="col-md-6 mb-4 stretch-card transparent" >
                  <div class="card card-tale" style="background-color: yellowgreen;">
                    <div class="card-body">
                      <p class="mb-4"># of employees</p>
                      <a class="fs-30 mb-2" href="{% url 'management_list_employee' %}">{{employees}}</a>
                      
                    </div>
                  </div>
                
                </div>
                <div class="col-md-6 mb-4 stretch-card transparent">
                  <div class="card card-dark-blue">
                    <div class="card-body">
                      <p class="mb-4">my To Do</p>
                      <a class="fs-30 mb-2" href="#todoDiv">{{todos | length}}</a>
                      
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-4 mb-lg-0 stretch-card transparent">
                  <div class="card card-light-blue">
                    <div class="card-body">
                      <p class="mb-4">latest</p>
                      <a class="fs-30 mb-2" href="{% url 'management_events' %}">{{event | length}}</a>
                      
                    </div>
                  </div>
                </div>
                <div class="col-md-6 stretch-card transparent">
                  <div class="card card-light-danger">
                    <div class="card-body">
                      <p class="mb-4">downloads updates</p>
                      <p class="fs-30 mb-2">{{payrolls | length}}</p>
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        
          <div class="row">
            <div class="col-md-4 stretch-card grid-margin"  style="overflow-y: scroll; height: 300px;">
              <div class="card">
                <div class="card-body">
                  <p class="card-title mb-0">System Generated Files</p>
                  <div class="table-responsive">
                    <table class="table table-borderless">
                      <thead>
                        <tr>
                          <th class="pl-0  pb-2 border-bottom">Id</th>
                          
                          <th class="border-bottom pb-2">Created</th>
                          <th class="border-bottom pb-2">Download </th>
                        </tr>
                      </thead>
                      <tbody>
                    
                        {% for payroll in payrolls %}
                        <tr>
                          <td class="pl-0">{{payroll.employee_id}}</td>
                          <td><p class="mb-0"><span class="font-weight-bold mr-2"></span>{{payroll.created_date}}{{payroll.created_time}}</p></td>
                          <td class="text-muted"><a href="{% url 'payroll-payslip' payroll.sign_id %}" download><i class="ti-download"></i></a></td>
                        </tr>
                        {% endfor %}
                        
                        
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-2 stretch-card grid-margin">
              <div class="row">
                <div class="col-md-12 grid-margin stretch-card">
                  <div class="card">
                    <div class="card-body">
                      <p class="card-title">Departments</p>
                      <div class="charts-data">
                        <div class="mt-3">
                          <p class="mb-0"># departments</p>
                          <div class="d-flex justify-content-between align-items-center">
                            <div class="progress progress-md flex-grow-1 mr-4">
                              <div class="progress-bar bg-inf0" role="progressbar" style="width: 0%" aria-valuenow="95" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <h4 class="mb-0">{{department}}</h4>
                          </div>
                        </div>
                        
                       
                       
                      </div>  
                    </div>
                  </div>
                </div>
                <div class="col-md-12 stretch-card grid-margin grid-margin-md-0">
                  <div class="card data-icon-card-primary">
                    <div class="card-body">
                      <p class="card-title text-white">Announcements</p>                      
                      <div class="row">
                        <div class="col-8 text-white">
                          <h3>{{event | length}}</h3>
                          <p class="text-white font-weight-500 mb-0">{{event.details}}</p>
                          <p class="text-white font-weight-500 mb-0"> </p>
                        </div>
                        <svg width="64px" height="64px" viewBox="-0.21 0 32.871 32.871" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="announcement" transform="translate(-779.053 -112.499)"> <path id="Rectangle_16" data-name="Rectangle 16" d="M5,0H9.947a0,0,0,0,1,0,0V10a0,0,0,0,1,0,0H5A5,5,0,0,1,0,5V5A5,5,0,0,1,5,0Z" transform="translate(780.053 120.499)" fill="#18f708" stroke="#2810da" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path> <path id="Path_43" data-name="Path 43" d="M804,137.446,790,130.5v-10l14-7Z" fill="#18f708" stroke="#2810da" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path> <line id="Line_52" data-name="Line 52" x2="8" y2="13.501" transform="translate(786 130.499)" fill="none" stroke="#2810da" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></line> <line id="Line_53" data-name="Line 53" x2="4" transform="translate(807.053 125.499)" fill="none" stroke="#2810da" stroke-miterlimit="10" stroke-width="2"></line> <line id="Line_54" data-name="Line 54" y1="2" x2="4" transform="translate(807.053 119.499)" fill="none" stroke="#2810da" stroke-miterlimit="10" stroke-width="2"></line> <line id="Line_55" data-name="Line 55" x2="4" y2="2" transform="translate(807.053 129.499)" fill="none" stroke="#2810da" stroke-miterlimit="10" stroke-width="2"></line> </g> </g></svg>
                      </div>
                    </div>
                  </div>
                </div>.
              </div>
            </div>
            <div class="col-md-6 stretch-card grid-margin" id="todoDiv">
              <div class="card" style="overflow-y:scroll; height:500px;" >
                <div class="card-body">
                  <p class="card-title">To do</p>
                  <a class="btn btn-light" onclick="location.reload" style="background-color: #94a0b4;"><i class="fa fa-refresh"></i></a>
                                                                                                                                                                                          
                    
                        <div class="li-wrapper px-3" >
                          <ul class="d-flex flex-column-reverse todo-list">
                            
                            {% for todo in todos %}
                            <li style="border-width: 100px;">
                              <div class="form-check">
                                <label class="form-check-label">
                                  <input class="checkbox" type="checkbox" onclick="getPk('{{todo.0}}')">
                                  {{todo.5}} <strong style="color:green">{{todo.6}}</strong> <small> {{todo.2}} {{todo.7}}</small>
                                </label>
                              </div>
                              &nbsp;&nbsp;&nbsp;&nbsp;
                              <a href="{{todo.4}}" download><i class="remove ti-download"></i>attachment</a>
                              &nbsp;&nbsp;&nbsp;
                              <button class="btn btn-light" style="background-color:azure;" onclick="approveModal('{{todo.0}}','{{todo.4}}')" class="btn btn-outline"><svg width="44px" height="44px" viewBox="0 0 50 50" data-name="Layer 1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><defs><style>.cls-1{fill:#231f20;}.cls-2{fill:#ffba50;}.cls-3{fill:#7cc05b;}.cls-4{fill:#8d7f89;}</style></defs><title></title><path class="cls-1" d="M8.513,25.5h9.875a3.1,3.1,0,0,0,3.058,2.608h7.108A3.1,3.1,0,0,0,31.612,25.5h9.875A4.017,4.017,0,0,0,45.5,21.487V16.833a4.007,4.007,0,0,0-3.784-3.99,3.105,3.105,0,0,0-3.057-2.6H31.551A3.107,3.107,0,0,0,28.5,12.82H22.2V11.492a.5.5,0,0,0-.43-.5l-2.047-.289,1.243-1.65a.5.5,0,0,0-.045-.654L18.292,5.779a.5.5,0,0,0-.654-.046L15.987,6.977,15.7,4.93A.5.5,0,0,0,15.2,4.5H11.492a.5.5,0,0,0-.5.43l-.289,2.047L9.058,5.733a.5.5,0,0,0-.654.046L5.779,8.4a.5.5,0,0,0-.046.654l1.244,1.65L4.93,11a.5.5,0,0,0-.43.5V15.2a.5.5,0,0,0,.43.495l2.047.288L5.733,17.638a.5.5,0,0,0,.046.654L8.4,20.917a.5.5,0,0,0,.654.046l1.65-1.243L11,21.766a.5.5,0,0,0,.5.43H15.2a.5.5,0,0,0,.495-.43l.288-2.047,1.651,1.244a.5.5,0,0,0,.654-.046l2.625-2.625a.5.5,0,0,0,.045-.654l-1.243-1.651,2.047-.288a.5.5,0,0,0,.43-.495V13.82H28.49a3.1,3.1,0,0,0,3.061,2.636h7.108a3.1,3.1,0,0,0,3.058-2.613,3.008,3.008,0,0,1,2.783,2.99v4.654A3.017,3.017,0,0,1,41.487,24.5H31.612a3.1,3.1,0,0,0-3.058-2.608H21.446A3.1,3.1,0,0,0,18.388,24.5H8.513A4.017,4.017,0,0,0,4.5,28.513v4.654a4.007,4.007,0,0,0,3.784,3.99,3.105,3.105,0,0,0,3.057,2.6h7.108A3.107,3.107,0,0,0,21.5,37.18h6.142a8.958,8.958,0,1,0-.012-1H21.51a3.1,3.1,0,0,0-3.061-2.636H11.341a3.1,3.1,0,0,0-3.058,2.613A3.008,3.008,0,0,1,5.5,33.167V28.513A3.017,3.017,0,0,1,8.513,25.5Zm4.835-8.582a3.57,3.57,0,1,1,3.57-3.57A3.574,3.574,0,0,1,13.348,16.918Z"></path><path class="cls-2" d="M38.659,15.456H31.551a2.108,2.108,0,1,1,0-4.216h7.108a2.108,2.108,0,1,1,0,4.216Z"></path><path class="cls-2" d="M21.446,22.892h7.108a2.108,2.108,0,0,1,2.105,2.076c0,.011-.006.021-.006.032s.006.021.006.032a2.108,2.108,0,0,1-2.105,2.076H21.446a2.108,2.108,0,0,1-2.105-2.076c0-.011.006-.021.006-.032s-.006-.021-.006-.032A2.108,2.108,0,0,1,21.446,22.892Z"></path><path class="cls-2" d="M11.341,34.544h7.108a2.108,2.108,0,1,1,0,4.216H11.341a2.108,2.108,0,0,1,0-4.216Z"></path><circle class="cls-1" cx="22.482" cy="25" r="0.502"></circle><circle class="cls-1" cx="25.024" cy="25" r="0.502"></circle><circle class="cls-1" cx="27.518" cy="25" r="0.502"></circle><circle class="cls-1" cx="32.587" cy="13.348" r="0.502"></circle><circle class="cls-1" cx="35.129" cy="13.348" r="0.502"></circle><circle class="cls-1" cx="37.622" cy="13.348" r="0.502"></circle><circle class="cls-1" cx="17.413" cy="36.652" r="0.502"></circle><circle class="cls-1" cx="14.871" cy="36.652" r="0.502"></circle><circle class="cls-1" cx="12.378" cy="36.652" r="0.502"></circle><path class="cls-3" d="M36.557,28.615a7.943,7.943,0,1,1-7.942,7.942A7.952,7.952,0,0,1,36.557,28.615Z"></path><path class="cls-4" d="M18.74,15.115,21.2,14.77V11.927l-2.456-.346a.5.5,0,0,1-.33-.8L19.9,8.8l-2.01-2.011L15.911,8.286a.5.5,0,0,1-.8-.33L14.77,5.5H11.926l-.345,2.456a.5.5,0,0,1-.8.33L8.8,6.793,6.793,8.8l1.493,1.981a.5.5,0,0,1-.33.8L5.5,11.927V14.77l2.456.345a.5.5,0,0,1,.33.8L6.793,17.892,8.8,19.9l1.981-1.493a.5.5,0,0,1,.8.33l.345,2.456H14.77l.345-2.456a.5.5,0,0,1,.8-.33L17.892,19.9l2.01-2.011L18.41,15.911a.5.5,0,0,1,.33-.8Zm-5.392,1.8a3.57,3.57,0,1,1,3.57-3.57A3.574,3.574,0,0,1,13.348,16.918Z"></path><path class="cls-1" d="M13.348,8.778a4.57,4.57,0,1,0,4.57,4.57A4.575,4.575,0,0,0,13.348,8.778Zm0,8.14a3.57,3.57,0,1,1,3.57-3.57A3.574,3.574,0,0,1,13.348,16.918Z"></path><path class="cls-1" d="M35.751,38.763a.5.5,0,0,0,.707,0l4.124-4.124a.5.5,0,0,0-.707-.707L36.1,37.7,34.272,35.87a.5.5,0,0,0-.707.707Z"></path></g></svg>Process Request</button>
                             
                              
                           
                            </li>
                            {% endfor %}

                         
                            
                            
                            
                            
                          </ul>
                        </div>
                      
               
                </div>
              </div>
            </div>
          </div>
          <!--
          <div class="row">
            <div class="col-md-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title">Attendance trends</p>
                  <p class="font-weight-500"></p>
                 
                  <canvas id="order-chart"></canvas>
                </div>
              </div>
            </div>
            <div class="col-md-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                 <div class="d-flex justify-content-between">
                  <p class="card-title">expected vs Actual</p>
                  <a href="#" class="text-info">View all</a>
                 </div>
                  <p class="font-weight-500"></p>
                  <div id="sales-legend" class="chartjs-legend mt-4 mb-2"></div>
                  <canvas id="sales-charts"></canvas>
                </div>
              </div>
            </div>
          </div>
        -->
          
         
          
          <div class="row">
            <div class="col-md-12 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <p class="card-title">My attendance</p>
                  <div class="row">
                    <div class="col-12">
                      <div class="table-responsive">
                        <table id="newemp" class="display expandable-table" style="width:100%">
                          <thead>
                            <tr>
                              <th>Employee #</th>
                              <th>Day</th>
                              <th>Days</th>
                              <th>Hours</th>
                              <th>Deductions</th>
                              <th>Remaining Leave Days</th>
                              <th>Status</th>
                          
                              <th>Remarks</th>
                            </tr>
                          </thead>
                          <tbody>
                           
                            {% for att in attendance %}
                            <tr>
                                
                                <td>{{att.employee.emp_id}}</td>
                                <td>{{att.day}}</td>
                                <td>{{att.days}}</td>
                                <td>{{att.hours}}</td>
                                <td>{{att.deductions}}</td>
                                <td>{{att.leave_days}}</td>
                                <td>{{att.status}}</td>
                                <td>{{att.remarks}}</td>
                            </tr>
                            {% endfor %}
                           
                          </tbody>
                      </table>
                      </div>
                    </div>
                  </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#approveModal" id="approveModalBtn" style="display:none">
          
        </button>
        
        <!-- Modal -->
        <div class="modal fade" id="approveModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Details</h5>
                <div id="loaders2" style="display: none;">
                  <div class="spinner-grow text-primary" role="status">
                    <span class="sr-only">Loading...</span>
                  </div>
                  <div class="spinner-grow text-secondary" role="status">
                    <span class="sr-only">Loading...</span>
                  </div>
                  <div class="spinner-grow text-success" role="status">
                    <span class="sr-only">Loading...</span>
                  </div>
                  </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <a class="btn btn-light" onclick="hideDetails()"><svg width="24px" height="24px" viewBox="-0.5 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M19.91 14.255C20.15 14.065 20.37 13.845 20.59 13.615L21.35 12.845C21.55 12.645 21.55 12.325 21.35 12.125L20.59 11.355C17.52 8.265 13.22 7.165 9.26999 8.085H9.26001" stroke="#e70d0d" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M4.09 10.735C3.85 10.925 3.63001 11.145 3.41001 11.375L2.65 12.145C2.45 12.345 2.45 12.665 2.65 12.865L3.41001 13.635C6.48001 16.725 10.78 17.825 14.73 16.905H14.74" stroke="#e70d0d" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M11.46 14.995C10.93 14.885 10.46 14.605 10.11 14.215" stroke="#e70d0d" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M13.9001 10.775C13.5501 10.385 13.08 10.105 12.55 9.995" stroke="#e70d0d" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M3.59998 7.63501L20.41 17.365" stroke="#e70d0d" stroke-miterlimit="10" stroke-linecap="round"></path> </g></svg>hide</a>
                <a class="btn btn-light" onclick="showDetails()"><svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Edit / Show"> <g id="Vector"> <path d="M3.5868 13.7788C5.36623 15.5478 8.46953 17.9999 12.0002 17.9999C15.5308 17.9999 18.6335 15.5478 20.413 13.7788C20.8823 13.3123 21.1177 13.0782 21.2671 12.6201C21.3738 12.2933 21.3738 11.7067 21.2671 11.3799C21.1177 10.9218 20.8823 10.6877 20.413 10.2211C18.6335 8.45208 15.5308 6 12.0002 6C8.46953 6 5.36623 8.45208 3.5868 10.2211C3.11714 10.688 2.88229 10.9216 2.7328 11.3799C2.62618 11.7067 2.62618 12.2933 2.7328 12.6201C2.88229 13.0784 3.11714 13.3119 3.5868 13.7788Z" stroke="#19f027" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M10 12C10 13.1046 10.8954 14 12 14C13.1046 14 14 13.1046 14 12C14 10.8954 13.1046 10 12 10C10.8954 10 10 10.8954 10 12Z" stroke="#19f027" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g> </g></svg>show</a>
               <div id="detDiv">
                
                
                <div style="color:black; background-color:azure; overflow-y:scroll; overflow-x:scroll; border:2px;"  style="height:300px; margin:40px;">
                  
                   
                   <svg width="34px" height="34px" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M512 661.3c-117.6 0-213.3-95.7-213.3-213.3S394.4 234.7 512 234.7 725.3 330.4 725.3 448 629.6 661.3 512 661.3z m0-341.3c-70.6 0-128 57.4-128 128s57.4 128 128 128 128-57.4 128-128-57.4-128-128-128z" fill="#5F6379"></path><path d="M837 862.9c-15.7 0-30.8-8.7-38.2-23.7C744.3 729.5 634.4 661.3 512 661.3s-232.3 68.1-286.8 177.9c-10.5 21.1-36.1 29.7-57.2 19.2s-29.7-36.1-19.2-57.2C217.8 662.3 357 576 512 576s294.2 86.3 363.2 225.2c10.5 21.1 1.9 46.7-19.2 57.2-6.1 3-12.6 4.5-19 4.5z" fill="#5F6379"></path><path d="M512 1002.7c-270.6 0-490.7-220.1-490.7-490.7S241.4 21.3 512 21.3s490.7 220.1 490.7 490.7-220.1 490.7-490.7 490.7z m0-896c-223.5 0-405.3 181.8-405.3 405.3S288.5 917.3 512 917.3 917.3 735.5 917.3 512 735.5 106.7 512 106.7z" fill="#3688FF"></path></g></svg><strong id="applicant"></strong>
                   <br>
                   <br>
                   <h4 style="color:blue">Department:</h4>
                  <h4 id="department"></h4>
                  <br>
                 
                  <h4 style="color:blue">Type:</h4>
                  <h4 id="title"></h4>
                  <br>
                  <h4 style="color:blue">Details</h4>
                  <div id="details"></div>
                   <br>
                   <h4 style="color:blue">From:</h4>
                  
                   <svg width="34px" height="34px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M16.9995 15.9995L20.9995 11.9995M20.9995 11.9995L16.9995 7.99951M20.9995 11.9995H8.99951M12.9995 20.9995H6.20029C5.08019 20.9995 4.52014 20.9995 4.09231 20.7815C3.71599 20.5898 3.41003 20.2838 3.21828 19.9075C3.00029 19.4797 3.00029 18.9196 3.00029 17.7995V6.19951C3.00029 5.07941 3.00029 4.51935 3.21828 4.09153C3.41003 3.71521 3.71599 3.40925 4.09231 3.2175C4.52014 2.99951 5.08019 2.99951 6.20029 2.99951L12.9995 2.99951" stroke="#310af5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>&nbsp;&nbsp;<strong id="start"></strong>
                   <br>
                   <h4 style="color:blue">To:</h4>
                   <svg width="34px" height="34px" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <rect width="48" height="48" fill="white" fill-opacity="0.01"></rect> <path d="M14 23.9917L42 23.9917" stroke="#0938f6" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M26 36L14 24L26 12" stroke="#0938f6" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M5 36L5 12" stroke="#0938f6" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>&nbsp;&nbsp;<strong id="end"></strong>
                   <br>
                   <br>
                   <h4 style="color:blue">Days:</h4>
                   
                   <svg width="34px" height="34px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Calendar / Calendar_Days"> <path id="Vector" d="M8 4H7.2002C6.08009 4 5.51962 4 5.0918 4.21799C4.71547 4.40973 4.40973 4.71547 4.21799 5.0918C4 5.51962 4 6.08009 4 7.2002V8M8 4H16M8 4V2M16 4H16.8002C17.9203 4 18.4796 4 18.9074 4.21799C19.2837 4.40973 19.5905 4.71547 19.7822 5.0918C20 5.5192 20 6.07899 20 7.19691V8M16 4V2M4 8V16.8002C4 17.9203 4 18.4801 4.21799 18.9079C4.40973 19.2842 4.71547 19.5905 5.0918 19.7822C5.5192 20 6.07899 20 7.19691 20H16.8031C17.921 20 18.48 20 18.9074 19.7822C19.2837 19.5905 19.5905 19.2842 19.7822 18.9079C20 18.4805 20 17.9215 20 16.8036V8M4 8H20M16 16H16.002L16.002 16.002L16 16.002V16ZM12 16H12.002L12.002 16.002L12 16.002V16ZM8 16H8.002L8.00195 16.002L8 16.002V16ZM16.002 12V12.002L16 12.002V12H16.002ZM12 12H12.002L12.002 12.002L12 12.002V12ZM8 12H8.002L8.00195 12.002L8 12.002V12Z" stroke="#0930f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg><strong id="days"></strong>
                   <br>
                   
                   <br>

                  
                </div>
                
                
                <br>
             
                <button class="btn btn-outline" onclick="getApprovers()"><svg height="34px" width="34px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 18.566 18.566" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path style="fill:#1acf17;" d="M17.705,11.452h-0.73v-3.65c0.929-0.352,1.591-1.247,1.591-2.299c0-1.359-1.102-2.46-2.461-2.46 c-1.044,0-1.936,0.651-2.291,1.568h-1.668V4.522c0-0.475-0.384-0.86-0.859-0.86h-5.2c-0.475,0-0.859,0.386-0.859,0.86V4.61H3.566 V2.924c0-0.475-0.385-0.86-0.859-0.86H1.24c-0.475,0-0.859,0.385-0.859,0.86v5.199c0,0.476,0.385,0.859,0.859,0.859h1.467 c0.474,0,0.859-0.384,0.859-0.859V5.9h1.663v0.089c0,0.475,0.384,0.86,0.859,0.86h5.199c0.476,0,0.859-0.385,0.859-0.86V5.9h1.533 c0.168,1.032,0.977,1.848,2.006,2.025v3.527h-3.179c-0.475,0-0.859,0.385-0.859,0.858v0.089H9.851v-1.955 c0-0.474-0.386-0.859-0.86-0.859H7.524c-0.475,0-0.859,0.386-0.859,0.859v1.955H4.833c-0.284-1.046-1.237-1.815-2.372-1.815 C1.102,10.584,0,11.686,0,13.044c0,1.359,1.102,2.46,2.461,2.46c1.136,0,2.088-0.769,2.372-1.815h1.832v1.955 c0,0.476,0.385,0.859,0.859,0.859h1.467c0.474,0,0.86-0.384,0.86-0.859v-1.955h1.796v0.089c0,0.476,0.385,0.859,0.859,0.859h5.199 c0.476,0,0.86-0.384,0.86-0.859v-1.467C18.565,11.837,18.18,11.452,17.705,11.452z"></path> </g> </g></svg>view approvers</button>
                
             
                <br>
                <div id="approversInfo" style="height: 300px; overflow-y: scroll; display:none">
                  <div id="loaders880" style="display: none;">
                    <div class="spinner-grow text-primary" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-secondary" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow text-success" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    </div>

                </div>
                
                </div>
                <br><br>
                <form class="forms-sample">
                  <div class="form-group">
                    <label for="exampleInputName1"></label>
                    <input type="hidden" class="form-control" id="approvePk" placeholder="Name">
                  </div>
                  
                  <div class="form-group">
                    <label for="exampleSelectGender">Action</label>
                      <select class="form-control" id="approveStatus"> 
                        <option value="approve">Approve</option>
                        <option value="reject">Reject</option>
                      </select>
                    </div>
                  
                 
                  <div class="form-group">
                    <label for="exampleTextarea1">Remarks</label>
                    <textarea class="form-control" id="approveComments" rows="4"></textarea>
                  </div>
                  <button type="button" class="btn btn-primary mr-2" onclick="doneApprove()">Submit</button>
                
                </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                
              </div>
            </div>
          </div>
        </div>

        <!-- content-wrapper ends -->
        <!-- partial:partials/_footer.html -->
        <footer class="footer">
          
        </footer>
        <!-- partial -->
      </div>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
      <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>
      <script>
        
    new DataTable('#newemp');
     
// approval modal
function approveModal(id,link){

    
  $("#approveModalBtn").click()

  $("#approvePk").val(id)
  
  //$("#attach").href(link)

  $.ajax({

      type:"POST",
      url:"{% url 'management_view_approval_details' %}",
      data:{

         id:id
      },
      beforeSend:function(){
                $("#loaders2").show()
             },
      success:function(data,status){
       
        document.getElementById("title").innerHTML = data["title"]+" : "+data["category"]
        document.getElementById("details").innerHTML = data["details"]
        document.getElementById("start").innerHTML = data["start"]
        document.getElementById("end").innerHTML = data["end"]
        document.getElementById("days").innerHTML = data["days"]
        document.getElementById("applicant").innerHTML = data["applicant"]
        document.getElementById("department").innerHTML = data["department"]
      },
      complete:function(){
                
                $("#loaders2").hide()
                
  
               }
  })
}

function hideDetails(){
    
    $("#detDiv").hide()
}
function showDetails(){
    
    $("#detDiv").show()
}
function doneApprove(){

  $.ajax({
    type:"post",
    url:"{% url 'management_approve_by_details' %}",
    data:{

      id:$("#approvePk").val(),
      status:$("#approveStatus").val(),
      comments:$("#approveComments").val(),
      csrfmiddlewaretoken:'{{ csrf_token }}'



    },
    beforeSend:function(){
                $("#loaders2").show()
             },
            
    success:function(data,status){
      alert(data)
    },
    complete:function(){
                
                $("#loaders2").hide()
               
                location.reload()
               }
     
  })

}
    // approve todo 
function getPk(id){
 
   $.ajax({

      type:"post",
      url:"{% url 'management_approve' %}",
      data:{
        id:id,
        csrfmiddlewaretoken:'{{ csrf_token }}'

      },
      beforeSend:function(){
                $("#loaders5").show()
             },

      success:function(data,status){
        alert(data)
      },
      complete:function(){
                
                $("#loaders5").hide()
                location.reload()
  
               }
   })
}

// reject todo 

function reject(id){

            $.ajax({

          type:"post",
          url:"{% url 'management_reject' %}",
          data:{
            id:id,
            csrfmiddlewaretoken:'{{ csrf_token }}'

          },
          beforeSend:function(){
                $("#loaders5").show()
             },
          success:function(data,status){
            alert(data)
          },
          complete:function(){
                
                $("#loaders5").hide()
                location.reload()
  
               }
          })

}

// view application details

function viewMore(){

    $("#viewMoreBtn").click()
}

//============================== fetch weather data==========================================

function getWeatherData(lat,lon){

var url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=4fa5737c18f70c57a4aa1c17b818a7b3`
  fetch(url).then(
    function(resp){
      return resp.json()
    }
  ).then(
    function(data){
      console.log(data.weather[0].main)
      document.getElementById("temps").innerHTML =  Math.round(parseFloat(data.main.temp)-273.15)
    }
  )
}

//getWeatherData('-1.292066','36.821945')

function workStatus(){

  var work_time = 'https://images.unsplash.com/photo-1506452819137-0422416856b8?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8d29yayUyMHRpbWV8ZW58MHx8MHx8fDA%3D'
  var tea_time = 'https://images.unsplash.com/photo-1588710962678-845d46818fd0?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YnJlYWslMjB0aW1lfGVufDB8fDB8fHww'
  var lunch_break = 'https://images.unsplash.com/photo-1567934124115-2eca8953796b?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fHBsYXRlfGVufDB8fDB8fHww'
  var rest_time = 'https://images.unsplash.com/photo-1586084531072-e03cbf17afa6?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8cmVzdHxlbnwwfHwwfHx8MA%3D%3D'

  const today = new Date();
          
  let h = today.getHours();
 
  if(h >= 8 && h <10){
   
      document.getElementById("statusPic").src = work_time
      document.getElementById("statusText").innerHTML = "Work time"

  }else if (h==10){
     
    document.getElementById("statusPic").src = tea_time
    document.getElementById("statusText").innerHTML = "Tea Break"
  } else if (h>=11 && h<13){
    document.getElementById("statusPic").src = work_time
    document.getElementById("statusText").innerHTML = "Work time"
  }else if (h==13){
    document.getElementById("statusPic").src = lunch_break
    document.getElementById("statusText").innerHTML = "Lunch Break"
  }else if(h>=14 && h<=17){
    document.getElementById("statusPic").src = work_time
    document.getElementById("statusText").innerHTML = "Work time"
  }
  else{
    document.getElementById("statusPic").src = rest_time
    document.getElementById("statusText").innerHTML = "Rest"
  }
}
workStatus()
setInterval(workStatus,90000)

// ============clear cache =======================
function clearCache(){


   $('head').append(`


<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'> 
   
   `)

   location.reload()
}

// approvers details

function getApprovers(){
  
      document.getElementById("approversInfo").style.display = "block"
      $.ajax({
           
          type:"post",
          url:"{% url 'management_get_approvals_name' %}",
          data:{

               pk:$("#approvePk").val()
          },
          beforeSend:function(){
                $("#loaders880").show()
             },
          success:function(data,status){

            //var data = JSON.parse(data)
            $("#approversInfo").html('')
            for(key in data){
              
                 
              $("#approversInfo").append(

              `
              <div class="tree">
              <ul>
               
                
                  <li>
                      <span style="background-color:aquamarine"><i class="icon-calendar"></i>${data[key]["status"]}</span>
                      <ul>
                        
                          <li>
                           
                              <ul>
                                  <li>
                                    <strong>${data[key]["name"]}</strong>
                                  </li>
                              </ul>
                          </li>
                         
                          
                          
                      </ul>
                  </li>
                
         
                  
              </ul>
          </div>
              
              
              `

              )
            }

            
          },
          complete:function(){
                
                $("#loaders880").hide()
              
  
               }
      })
    
     
}
function hideApprovers(){
  document.getElementById("approversInfo").style.display = "none"
}



      </script>
{% endblock content %}
