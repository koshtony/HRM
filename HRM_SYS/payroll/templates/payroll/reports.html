{% extends 'management/base.html' %}

{% block content %} 

<div class="main-panel">
    <!-- row -->
    <div class="content-wrapper">
            
        <div class="row page-titles mx-0">
            <div class="col-sm-6 p-md-0">
                <div class="welcome-text">
                    <h4>Reports</h4>
                </div>
            </div>
            
        </div>
        
        <div class="row">
            <div class="col-lg-12">
                <ul class="nav nav-pills mb-3">
                    <li class="nav-item"><a href="#list-view" data-toggle="tab" class="nav-link btn-primary mr-1 show active">Attendance</a></li>
                    <li class="nav-item"><a href="#grid-view" data-toggle="tab" class="nav-link btn-primary">payroll</a></li>
                    <li class="nav-item"><a href="#settings" data-toggle="tab" class="nav-link btn-primary">settings</a></li>
                </ul>
            </div>
            <div class="col-lg-12">
                <div class="row tab-content">
                    <div id="list-view" class="tab-pane fade active show col-lg-12">
                        <div class="card">
                            
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table  class="table table-striped"  id="attendance">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>day</th>
                                                <th>clock_in</th>
                                                <th>clock_out</th>
                                                <th>clock in location</th>
                                                <th>clock out location</th>
                                                <th>clock in image</th>
                                                <th>clock out image</th>
                                                <th>status</th>
                                                <th>count</th>
                                                <th>deduction</th>
                                               
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for attendance in attendances %}
                                            <tr>

                                                <td>
                                                    {{attendance.employee.emp_id}}

                                                </td>
                                                <td>
                                                    {{attendance.day}}
                                                </td>
                                                <td>
                                                    {{attendance.clock_in}}
                                                </td>
                                                <td>
                                                    {{attendance.clock_out}}
                                                </td>
                                                <td>
                                                    <button onclick="showMap('{{attendance.lat}}','{{attendance.long}}');"><i class="ti-map">show map</i></button>
                                                </td>
                                                <td>
                                                    {{attendance.lat1 }},{{attendance.long1}}
                                                </td>
                                                <td>
                                                    <img src="{{attendance.image1}}">
                                                </td>
                                                <td>
                                                    <img src="{{attendance.image2}}">
                                                </td>
                                                <td>
                                                    {{attendance.status}}
                                                </td>
                                                <td>
                                                    {{attendance.counts}}
                                                </td>
                                                <td>
                                                    {{attendance.deductions}}
                                                </td>
                                            </tr>
                                            {% endfor %}
                                            
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="grid-view" class="tab-pane fade col-lg-12">
                        <div class="row">
                            <div class="table-responsive">
                                <table  class="table table-striped"  id="payroll">
                                    <thead style="background-color: yellowgreen;">
                                        <tr>
                                            <th>#</th>
                                            <th>first_name</th>
                                          
                                            <th>national_id</th>
                                            <th>phone</th>
                                            <th>role</th>
                                            <th>account_no</th>
                                            <th>salary</th>
                                            <th>leave days</th>
                                            <th>hours</th>
                                            <th>deductions</th>
                                            <th>gross_pay</th>
                                            <th>taxable income</th>
                                            <th>PAYE</th>
                                            <th>nhif</th>
                                            <th>housing</th>
                                            <th>others</th>
                                            <th>net_pay</th>
                                           
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for col,val in payrolls.iterrows %}
                                        
                                        <tr>
                                            <td>
                                                {{val.employee_id}}

                                            </td>
                                            <td>
                                                {{val.name}}
                                            </td>
                                            <td>
                                                {{val.id_no}}
                                            </td>
                                            <td>
                                                {{val.phone}}
                                            </td>
                                            <td>
                                                {{val.role}}
                                            </td>
                                            <td>
                                                {{val.account_no}}
                                            </td>
                                            <td>
                                                {{val.basic_salary}}
                                            </td>
                                            <td>
                                                {{val.leave_days}}
                                            </td>
                                            <td>
                                                {{val.total_hours}}
                                            </td>
                                            <td>
                                                {{val.deductions}}
                                            </td>
                                            <td>
                                                {{val.gross_pay}}
                                            </td>
                                            <td>
                                                {{val.taxable_income}}
                                            </td>
                                            <td>
                                                {{val.tax}}
                                            </td>
                                            <td>
                                                {{val.nhif}}
                                            </td>
                                            <td>
                                                {{val.housing}}
                                            </td>
                                            <td>
                                                {{val.others}}
                                            </td>
                                            <td>
                                                {{val.net_pay}}
                                            </td>
                                           
                                            
                                        </tr>
                                        {% endfor %}
                                        
                                    </tbody>
                                </table>
                            </div>
                            
                        </div>
                    </div>
                    <div id="settings" class="tab-pane fade col-lg-12">
                        <div class="row">
                            <div class="col-md-6 mb-4 mb-lg-0 stretch-card transparent">
                            <div class="card card-light-blue">
                                    <div class="card-body">
                            <input type="date" class="form-control">
                            <input type="date" class="form-control">
                                    </div>
                                    </div>
                            </div>
                       </div>
            </div>
        </div>
       
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.7.0.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>
<script>
     new DataTable('#attendance');

     function showMap(lat,long){
       

        var mapProp= {
  center:new google.maps.LatLng(lat,long),
  zoom:5,
};
var map = new google.maps.Map(document.getElementById("Map"),mapProp);
     }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCvRNKaczQYKS20s1vGmfK9KGCxl5ksfV0&callback=showMap"></script

{% endblock content %}